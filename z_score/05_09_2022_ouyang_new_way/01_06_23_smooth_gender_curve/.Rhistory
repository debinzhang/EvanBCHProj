"rh_superiorparietal_thicknessstd",
"rh_superiortemporal_thicknessstd",
"rh_supramarginal_thicknessstd",
"rh_frontalpole_thicknessstd",
"rh_temporalpole_thicknessstd",
"rh_transversetemporal_thicknessstd",
"rh_insula_thicknessstd")
data_raw <- read.csv("all_subjects_cortical_metrics_RH_thicknessstd_09_15_2022_preHarmo_clean.csv",
stringsAsFactors = TRUE)
data_harmo <- read.csv("all_subjects_cortical_metrics_RH_thicknessstd_09_15_2022_postHarmo_clean.csv",
stringsAsFactors = TRUE)
gen_4_sheet_all_regions(data_raw, data_harmo, sex=3, byETIV=TRUE,
region_list=rh_thicknessstd_region_list, outfile="rh_thicknessstd_anova_age_as_key.xlsx",
genTukeyHSD=TRUE, genShadedPlot=TRUE)
gen_plot_all_region(rh_thicknessstd_region_list, 3)
if (draw_hemi_plot) {
gen_hemisphere_plots(rh_thicknessstd_region_list)
}
}
process_lh_thickness <- function() {
lh_thickness_region_list <- list("lh_bankssts_thickness",
"lh_caudalanteriorcingulate_thickness",
"lh_caudalmiddlefrontal_thickness",
"lh_cuneus_thickness",
"lh_entorhinal_thickness",
"lh_fusiform_thickness",
"lh_inferiorparietal_thickness",
"lh_inferiortemporal_thickness",
"lh_isthmuscingulate_thickness",
"lh_lateraloccipital_thickness",
"lh_lateralorbitofrontal_thickness",
"lh_lingual_thickness",
"lh_medialorbitofrontal_thickness",
"lh_middletemporal_thickness",
"lh_parahippocampal_thickness",
"lh_paracentral_thickness",
"lh_parsopercularis_thickness",
"lh_parsorbitalis_thickness",
"lh_parstriangularis_thickness",
"lh_pericalcarine_thickness",
"lh_postcentral_thickness",
"lh_posteriorcingulate_thickness",
"lh_precentral_thickness",
"lh_precuneus_thickness",
"lh_rostralanteriorcingulate_thickness",
"lh_rostralmiddlefrontal_thickness",
"lh_superiorfrontal_thickness",
"lh_superiorparietal_thickness",
"lh_superiortemporal_thickness",
"lh_supramarginal_thickness",
"lh_frontalpole_thickness",
"lh_temporalpole_thickness",
"lh_transversetemporal_thickness",
"lh_insula_thickness")
data_raw <- read.csv("all_subjects_cortical_metrics_LH_thickness_09_15_2022_preHarmo_clean.csv", stringsAsFactors = TRUE)
data_harmo <- read.csv("all_subjects_cortical_metrics_LH_thickness_09_15_2022_postHarmo_clean.csv", stringsAsFactors = TRUE)
gen_4_sheet_all_regions(data_raw, data_harmo, sex=3, byETIV=FALSE,
region_list=lh_thickness_region_list, outfile="lh_thickness_anova_all_age_as_key.xlsx", isLH=TRUE,
genTukeyHSD=TRUE, genShadedPlot=TRUE)
gen_plot_all_region(lh_thickness_region_list, 3)
}
process_rh_thickness <- function(draw_hemi_plot) {
rh_thickness_region_list <- list("rh_bankssts_thickness",
"rh_caudalanteriorcingulate_thickness",
"rh_caudalmiddlefrontal_thickness",
"rh_cuneus_thickness",
"rh_entorhinal_thickness",
"rh_fusiform_thickness",
"rh_inferiorparietal_thickness",
"rh_inferiortemporal_thickness",
"rh_isthmuscingulate_thickness",
"rh_lateraloccipital_thickness",
"rh_lateralorbitofrontal_thickness",
"rh_lingual_thickness",
"rh_medialorbitofrontal_thickness",
"rh_middletemporal_thickness",
"rh_parahippocampal_thickness",
"rh_paracentral_thickness",
"rh_parsopercularis_thickness",
"rh_parsorbitalis_thickness",
"rh_parstriangularis_thickness",
"rh_pericalcarine_thickness",
"rh_postcentral_thickness",
"rh_posteriorcingulate_thickness",
"rh_precentral_thickness",
"rh_precuneus_thickness",
"rh_rostralanteriorcingulate_thickness",
"rh_rostralmiddlefrontal_thickness",
"rh_superiorfrontal_thickness",
"rh_superiorparietal_thickness",
"rh_superiortemporal_thickness",
"rh_supramarginal_thickness",
"rh_frontalpole_thickness",
"rh_temporalpole_thickness",
"rh_transversetemporal_thickness",
"rh_insula_thickness")
data_raw <- read.csv("all_subjects_cortical_metrics_RH_thickness_09_15_2022_preHarmo_clean.csv", stringsAsFactors = TRUE)
data_harmo <- read.csv("all_subjects_cortical_metrics_RH_thickness_09_15_2022_postHarmo_clean.csv", stringsAsFactors = TRUE)
gen_4_sheet_all_regions(data_raw, data_harmo, sex=3, byETIV=FALSE,
region_list=rh_thickness_region_list, outfile="rh_thickness_anova_all_age_as_key.xlsx", isLH=FALSE,
genTukeyHSD=TRUE, genShadedPlot=TRUE)
gen_plot_all_region(rh_thickness_region_list, 3)
if (draw_hemi_plot) {
gen_hemisphere_plots(rh_thickness_region_list)
}
}
process_all <- function(draw_hemi_plot=TRUE, clean_leftover=TRUE) {
gen_raw_harmo_data()
process_lh_curvind()
process_rh_curvind(draw_hemi_plot)
# process_lh_foldind()
# process_rh_foldind(draw_hemi_plot)
# process_lh_gauscurv()
# process_rh_gauscurv(draw_hemi_plot)
# process_lh_meancurv()
# process_rh_meancurv(draw_hemi_plot)
# process_lh_thicknessstd()
# process_rh_thicknessstd(draw_hemi_plot)
# process_lh_thickness()
# process_rh_thickness(draw_hemi_plot)
categorize_data(clean_leftover)
}
process_all(FALSE, FALSE)
library(ggplot2)
library(dplyr)
wd <- "/Users/dzhang/Gits/EvanBCHProj/z_score/05_09_2022_ouyang_new_way/01_06_23_smooth_gender_curve"
setwd(wd)
file_path = "lh_bankssts_curvind_harmo_no_all_plot.csv"
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
data_raw
ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
geom_line() +
geom_point() +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age")
ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
geom_smooth(method = "lm") +
geom_point() +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age")
ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
geom_smooth(method = "lm") +
geom_point() + geom_point(alpha=0) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age")
ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
geom_smooth(method = "lm") +
geom_point(alpha=0) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age")
ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=NULL), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age")
ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=NULL), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age")
ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age")
title<-"Testing trendline by Sex"
u<- ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u+   u<- u + theme(plot.title = element_text(color="DarkBlue", size=9, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
title<-"Testing trendline by Sex"
u<- ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=9, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=20, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes (x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
theme(legend.position = "none") +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
#theme(legend.position = "none") +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
geom_point(alpha=1) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5)) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=3) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
title<-"lh_bankssts_curvind trendline by Sex"
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=12, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=5))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=15))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title)
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title) + theme(legend.position = c(0.87, 0.25))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title) + theme(legend.position = c(0.87, 0.85))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title) + theme(legend.position = c(0.85, 0.85))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title) +
theme(legend.position = c(0.85, 0.85), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="bankssts", x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="lh_bankssts", x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="lh_bankssts_curvind", x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
title<-"lh_bankssts_curvind trendlines by Sex"
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="lh_bankssts_curvind", x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
draw_trendline <- function(feature) {
file_path = paste(feature, "_harmo_no_all_plot.csv", sep = '')
title<-paste(feature, " trendlines by Sex", sep='')
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
u<- ggplot(data = data_raw, aes(x = Age, y=lh_bankssts_curvind, group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="lh_bankssts_curvind", x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
}
draw_trendline("lh_bankssts_curvind")
draw_trendline <- function(feature) {
file_path = paste(feature, "_harmo_no_all_plot.csv", sep = '')
title<-paste(feature, " trendlines by Sex", sep='')
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
u<- ggplot(data = data_raw, aes(x = Age, y=get(feature), group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y="lh_bankssts_curvind", x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
}
draw_trendline("lh_bankssts_curvind")
draw_trendline <- function(feature) {
file_path = paste(feature, "_harmo_no_all_plot.csv", sep = '')
title<-paste(feature, " trendlines by Sex", sep='')
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
u<- ggplot(data = data_raw, aes(x = Age, y=get(feature), group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y=feature, x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
}
draw_trendline("lh_bankssts_curvind")
draw_trendline <- function(feature) {
file_path = paste(feature, "_harmo_no_all_plot.csv", sep = '')
title<-paste(feature, " trendlines by Sex", sep='')
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
u<- ggplot(data = data_raw, aes(x = Age, y=get(feature), group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y=feature, x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
}
feature_list <- list("lh_bankssts_curvind")
for (feature in feature_list) {
draw_trendline(feature)
}
draw_trendline <- function(feature) {
print(paste("working on ", feature, " ...", sep = ''))
file_path = paste(feature, "_harmo_no_all_plot.csv", sep = '')
title<-paste(feature, " trendlines by Sex", sep='')
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
u<- ggplot(data = data_raw, aes(x = Age, y=get(feature), group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y=feature, x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
}
feature_list <- list("lh_bankssts_curvind")
for (feature in feature_list) {
draw_trendline(feature)
}
draw_trendline <- function(feature) {
print(paste("working on ", feature, " ...", sep = ''))
file_path = paste(feature, "_harmo_no_all_plot.csv", sep = '')
title<-paste(feature, " trendlines by Sex", sep='')
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
u<- ggplot(data = data_raw, aes(x = Age, y=get(feature), group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y=feature, x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
}
feature_list <- list("lh_bankssts_curvind")
for (feature in feature_list) {
draw_trendline(feature)
filename <- paste(feature, "_trendlines_by_sex.csv", sep = '')
ggsave(filename)
}
draw_trendline <- function(feature) {
print(paste("working on ", feature, " ...", sep = ''))
file_path = paste(feature, "_harmo_no_all_plot.csv", sep = '')
title<-paste(feature, " trendlines by Sex", sep='')
data_raw <- read.csv(file_path, stringsAsFactors = FALSE)
u<- ggplot(data = data_raw, aes(x = Age, y=get(feature), group=Sex, color = Sex)) +
#geom_smooth(method = "lm") +
#geom_point(alpha=0) +
geom_smooth(aes(color=Sex), method="gam", formula = y ~ s(x, bs = "cs", k=5), size=0.5) +
labs(y=feature, x = "Age") + ggtitle(title) +
theme(legend.position = c(0.90, 0.90), legend.background = element_rect(fill = "white", color = "black"))
u<- u + theme(plot.title = element_text(color="DarkBlue", size=15, family = "Courier", hjust=0.5)) +
theme(axis.text=element_text(size=10))
u
}
feature_list <- list("lh_bankssts_curvind")
for (feature in feature_list) {
draw_trendline(feature)
filename <- paste(feature, "_trendlines_by_sex.png", sep = '')
ggsave(filename)
}
feature_list <- list("lh_bankssts_curvind",
"lh_caudalanteriorcingulate_curvind",
"lh_caudalmiddlefrontal_curvind",
"lh_cuneus_curvind",
"lh_entorhinal_curvind",
"lh_fusiform_curvind",
"lh_inferiorparietal_curvind",
"lh_inferiortemporal_curvind",
"lh_isthmuscingulate_curvind",
"lh_lateraloccipital_curvind")
for (feature in feature_list) {
draw_trendline(feature)
filename <- paste(feature, "_trendlines_by_sex.png", sep = '')
ggsave(filename)
}
